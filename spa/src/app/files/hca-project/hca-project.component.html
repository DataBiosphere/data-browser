<pop-layout [tabs]="getProjectDetailTabs()" [activeTab]="getActiveTab()">
    <ng-container title>Explore Project</ng-container>
    <div content class="explore-project" *ngIf="state$ | async as state">
        <div class="project-title">
            <h2 class="fontsize-xl">{{state.project.project.projectTitle}}</h2>
            <div class="select-project"
                 (click)="onProjectSelected(state.selectedProjectIds, state.project.project.entryId, state.project.project.projectShortname)">
                <div class="chart-legend-bar"
                     [ngStyle]="getLegendStyle(isProjectSelected(state.selectedProjectIds, state.project.project.entryId))">
                    <mat-icon *ngIf="isProjectSelected(state.selectedProjectIds, state.project.project.entryId)">check
                    </mat-icon>
                </div>
                <span class="fontsize-xs">Select Project</span>
            </div>
        </div>
        <div class="project-overview">
            <div>
                <div class="project-description">
                    <h4 class="fontsize-m semi-bold">Description</h4>
                    <p class="fontsize-s">{{state.project.project.projectDescription}}</p>
                    <div class="stretch">
                        <h4 class="fontsize-m semi-bold">Contact</h4>
                        <ng-container [ngSwitch]="isAnyContactAssociated(state.project.contacts)">
                            <ng-container *ngSwitchCase="true">
                                <div *ngFor="let contact of state.project.contacts"
                                     class="details">
                                    <p class="fontsize-xxs">{{contact.name}}</p>
                                    <p class="fontsize-xxs">{{contact.institution}}</p>
                                    <p class="fontsize-xxs">{{contact.email}}</p>
                                </div>
                            </ng-container>
                            <p class="fontsize-xxs" *ngSwitchDefault>Unspecified</p>
                        </ng-container>
                        <h4 class="fontsize-m semi-bold">Publications</h4>
                        <ng-container [ngSwitch]="isAnyPublicationAssociated(state.project.project.publications)">
                            <ng-container *ngSwitchCase="true">
                                <div *ngFor="let publication of state.project.project.publications"
                                     class="details publications">
                                    <p class="fontsize-xxs" [innerHTML]="getProjectPublication(publication)"></p>
                                </div>
                            </ng-container>
                            <p *ngSwitchDefault class="fontsize-xxs">Unspecified</p>
                        </ng-container>
                    </div>
                    <div class="lhs contributors">
                        <h4 class="fontsize-m semi-bold">Contributors</h4>
                        <p class="fontsize-xxs contributor-list">
                            <ng-container [ngSwitch]="isAnyContributorAssociated(state.project.contributors)">
                                <ng-container *ngSwitchCase="true">
                                    <span *ngFor="let contributor of state.project.contributors">
                                        <span>{{contributor.name}}</span>
                                        <span *ngIf="contributor.role"> ({{contributor.role | titlecase}})</span>
                                        <sup>{{contributor.citation}}</sup>
                                    </span>
                                </ng-container>
                                <span *ngSwitchDefault>Unspecified</span>
                            </ng-container>
                        </p>
                    </div>
                    <div class="rhs">
                        <h4 class="fontsize-m semi-bold">Collaborating Organizations</h4>
                        <p class="fontsize-xxs organization-list">
                            <ng-container [ngSwitch]="isAnyCollaboratingOrganizationAssociated(state.project.collaboratingOrganizations)">
                                <ng-container *ngSwitchCase="true">
                                    <span *ngFor="let organization of state.project.collaboratingOrganizations">
                                        <sup>{{organization.citation}}</sup><span> {{organization.name}}</span>
                                    </span>
                                </ng-container>
                                <span *ngSwitchDefault>Unspecified</span>
                            </ng-container>
                        </p>
                        <h4 class="fontsize-m semi-bold">Data Curators</h4>
                        <p class="fontsize-xxs curator-list">
                            <ng-container [ngSwitch]="isAnyDataCuratorAssociated(state.project.dataCurators)">
                                <ng-container *ngSwitchCase="true">
                                    <span *ngFor="let curator of state.project.dataCurators">
                                        <span>{{curator}}</span>
                                    </span>
                                </ng-container>
                                <span *ngSwitchDefault>Unspecified</span>
                            </ng-container>
                        </p>
                        <h4 class="fontsize-m semi-bold">Citation</h4>
                        <p class="fontsize-xxs citation">
                            <span>To reference this project, please use the following link:</span>
                            <a [href]="getCitationLink(state.project.project.entryId)"><span class="url">{{getCitationLink(state.project.project.entryId)}}</span></a>
                            <copy-to-clipboard [copyToClipboardLink]="getCitationLink(state.project.project.entryId)"></copy-to-clipboard>
                        </p>
                    </div>
                </div>
            </div>
            <div>
                <div>
                    <div class="project-downloads" *ngIf="!isDeviceHandheld()">
                        <h4 class="fontsize-m semi-bold">Project Downloads</h4>
                        <div>
                            <p class="fontsize-xs semi-bold lhs">
                                <hca-tooltip [tooltipClass]="'hca-tooltip narrow'"
                                             [tooltipContent]="'Download project metadata'"
                                             [tooltipDisabled]="false"
                                             [tooltipPosition]="'above'">Project Metadata
                                </hca-tooltip>
                            </p>
                            <p class="fontsize-xs rhs downloads">
                                <span>
                                    <project-tsv-download [projectId]="state.project.project.entryId"
                                                          [projectTitle]="state.project.project.projectTitle">
                                        <span>tsv</span>
                                    </project-tsv-download>
                                </span>
                            </p>
                        </div>
                        <div>
                            <p class="fontsize-xs semi-bold lhs">
                                <hca-tooltip [tooltipClass]="'hca-tooltip narrow'"
                                             [tooltipContent]="'Download expression matrix'"
                                             [tooltipDisabled]="false"
                                             [tooltipPosition]="'above'">Expression Matrix
                                </hca-tooltip>
                            </p>
                            <p class="fontsize-xs rhs" *ngIf="state.projectMatrixUrls && !state.projectMatrixUrls.isAnyProjectMatrixUrlAvailable()">No expression matrix available</p>
                        </div>
                        <div *ngFor="let species of state.projectMatrixUrls.listSpeciesWithMatrixUrls()"
                             class="species-matrix-url">
                            <p class="fontsize-xs semi-bold subhead lhs">
                                <hca-tooltip [tooltipClass]="'hca-tooltip narrow'"
                                             [tooltipContent]="'Download expression matrix'"
                                             [tooltipDisabled]="false"
                                             [tooltipPosition]="'above'">{{species}}
                                </hca-tooltip>
                            </p>
                            <p class="fontsize-xs rhs downloads">
                                <span *ngFor="let matrixUrl of state.projectMatrixUrls.listMatrixUrlsBySpecies(species)"><a
                                        [href]="matrixUrl.url"><img
                                        src="assets/images/icon/hca-download-primary.png"/><span>{{matrixUrl.fileType}}</span></a></span>
                            </p>
                        </div>
                    </div>
                    <div class="project-integrations">
                        <h4 class="fontsize-m semi-bold">External Resources</h4>
                        <ng-container [ngSwitch]="state.integratedWithTertiaryPortals">
                            <ng-container *ngSwitchCase="true">
                                <div class="stretch">
                                    <p class="fontsize-xs">This project's data can be viewed live in the following
                                        external resources:</p>
                                </div>
                                <project-integrations [integrations]="state.integrations"></project-integrations>
                            </ng-container>
                            <p class="fontsize-xs" *ngSwitchDefault>There are currently no integrations for this project
                                at this time.</p>
                        </ng-container>
                    </div>
                    <div class="project-details">
                        <h4 class="fontsize-m semi-bold">Project Details</h4>
                        <div>
                            <p class="fontsize-xs semi-bold lhs">
                                <hca-tooltip [tooltipClass]="'hca-tooltip narrow'"
                                             [tooltipContent]="getColumnDescription('projectShortname')"
                                             [tooltipDisabled]="false"
                                             [tooltipPosition]="'above'">
                                    {{getColumnDisplayName('projectShortname')}}
                                </hca-tooltip>
                            </p>
                            <p class="fontsize-xs rhs">{{state.project.project.projectShortname}}</p>
                        </div>
                        <div>
                            <p class="fontsize-xs semi-bold lhs">
                                <hca-tooltip [tooltipClass]="'hca-tooltip narrow'"
                                             [tooltipContent]="getColumnDescription('genusSpecies')"
                                             [tooltipDisabled]="false"
                                             [tooltipPosition]="'above'">{{getColumnDisplayName('genusSpecies')}}
                                </hca-tooltip>
                            </p>
                            <p class="fontsize-xs rhs">{{stringifyValues(state.project.project.genusSpecies,
                                "Unspecified")}}</p>
                        </div>
                        <div>
                            <p class="fontsize-xs semi-bold lhs">
                                <hca-tooltip [tooltipClass]="'hca-tooltip narrow'"
                                             [tooltipContent]="getColumnDescription('sampleEntityType')"
                                             [tooltipDisabled]="false"
                                             [tooltipPosition]="'above'">{{getColumnDisplayName('sampleEntityType')}}
                                </hca-tooltip>
                            </p>
                            <p class="fontsize-xs rhs">{{stringifyValues(state.project.project.sampleEntityType,
                                "Unspecified")}}</p>
                        </div>
                        <div>
                            <p class="fontsize-xs semi-bold lhs">
                                <hca-tooltip [tooltipClass]="'hca-tooltip narrow'"
                                             [tooltipContent]="getColumnDescription('organ')"
                                             [tooltipDisabled]="false"
                                             [tooltipPosition]="'above'">{{getColumnDisplayName('organ')}}
                                </hca-tooltip>
                            </p>
                            <p class="fontsize-xs rhs">{{stringifyValues(state.project.project.organ,
                                "Unspecified")}}</p>
                        </div>
                        <div>
                            <p class="fontsize-xs semi-bold lhs">
                                <hca-tooltip [tooltipClass]="'hca-tooltip narrow'"
                                             [tooltipContent]="getColumnDescription('organPart')"
                                             [tooltipDisabled]="false"
                                             [tooltipPosition]="'above'"
                                >{{getColumnDisplayName('organPart')}}
                                </hca-tooltip>
                            </p>
                            <p class="fontsize-xs rhs">{{stringifyValues(state.project.project.organPart,
                                "Unspecified")}}</p>
                        </div>
                        <div *ngIf="!isSampleEntityTypeSpecimens(state.project.project.sampleEntityType)">
                            <p class="fontsize-xs semi-bold lhs">
                                <hca-tooltip [tooltipClass]="'hca-tooltip narrow'"
                                             [tooltipContent]="getColumnDescription('modelOrgan')"
                                             [tooltipDisabled]="false"
                                             [tooltipPosition]="'above'">{{getColumnDisplayName('modelOrgan')}}
                                </hca-tooltip>
                            </p>
                            <p class="fontsize-xs rhs">{{stringifyValues(state.project.project.modelOrgan,
                                "Unspecified")}}</p>
                        </div>
                        <div>
                            <p class="fontsize-xs semi-bold lhs">
                                <hca-tooltip [tooltipClass]="'hca-tooltip narrow'"
                                             [tooltipContent]="getColumnDescription('disease')"
                                             [tooltipDisabled]="false"
                                             [tooltipPosition]="'above'">{{getColumnDisplayName('disease')}}
                                </hca-tooltip>
                            </p>
                            <p class="fontsize-xs rhs">{{stringifyValues(state.project.project.disease,
                                "Unspecified")}}</p>
                        </div>
                        <div>
                            <p class="fontsize-xs semi-bold lhs">
                                <hca-tooltip [tooltipClass]="'hca-tooltip narrow'"
                                             [tooltipContent]="getColumnDescription('libraryConstructionApproach')"
                                             [tooltipDisabled]="false"
                                             [tooltipPosition]="'above'">
                                    {{getColumnDisplayName('libraryConstructionApproach')}}
                                </hca-tooltip>
                            </p>
                            <p class="fontsize-xs rhs"
                               [innerHTML]="stringifyValues(state.project.project.libraryConstructionApproach, '-')"></p>
                        </div>
                        <div>
                            <p class="fontsize-xs semi-bold lhs">
                                <hca-tooltip [tooltipClass]="'hca-tooltip narrow'"
                                             [tooltipContent]="getColumnDescription('pairedEnd')"
                                             [tooltipDisabled]="false"
                                             [tooltipPosition]="'above'">{{getColumnDisplayName('pairedEnd')}}
                                </hca-tooltip>
                            </p>
                            <p class="fontsize-xs rhs">{{stringifyValues(state.project.project.pairedEnd, '-')}}</p>
                        </div>
                        <div *ngIf="isWorkflowNotUnspecified(state.project.project.workflow)">
                            <p class="fontsize-xs semi-bold lhs">
                                <hca-tooltip [tooltipClass]="'hca-tooltip narrow'"
                                             [tooltipContent]="getColumnDescription('workflow')"
                                             [tooltipDisabled]="false"
                                             [tooltipPosition]="'above'">{{getColumnDisplayName('workflow')}}
                                </hca-tooltip>
                            </p>
                            <analysis-protocol-pipeline-linker class="fontsize-xs rhs" [workflow]="state.project.project.workflow"></analysis-protocol-pipeline-linker>
                        </div>
                        <div>
                            <p class="fontsize-xs semi-bold lhs">
                                <hca-tooltip [tooltipClass]="'hca-tooltip narrow'"
                                             [tooltipContent]="getColumnDescription('fileFormat')"
                                             [tooltipDisabled]="false"
                                             [tooltipPosition]="'above'">{{getColumnDisplayName('fileFormat')}}
                                </hca-tooltip>
                            </p>
                            <p class="fontsize-xs rhs">{{stringifyValues(state.project.project.fileType,
                                "Unspecified")}}</p>
                        </div>
                        <div>
                            <p class="fontsize-xs semi-bold lhs">
                                <hca-tooltip [tooltipClass]="'hca-tooltip narrow'"
                                             [tooltipContent]="getColumnDescription('totalCells')"
                                             [tooltipDisabled]="false"
                                             [tooltipPosition]="'above'">{{getColumnDisplayName('totalCells')}}
                                </hca-tooltip>
                            </p>
                            <p class="fontsize-xs rhs">{{state.project.project.totalCells | countSize}}</p>
                        </div>
                        <div>
                            <p class="fontsize-xs semi-bold lhs">
                                <hca-tooltip [tooltipClass]="'hca-tooltip narrow'"
                                             [tooltipContent]="getColumnDescription('donorCount')"
                                             [tooltipDisabled]="false"
                                             [tooltipPosition]="'above'">{{getColumnDisplayName('donorCount')}}
                                </hca-tooltip>
                            </p>
                            <p class="fontsize-xs rhs">{{state.project.project.donorCount | countSize}}</p>
                        </div>
                    </div>
                </div>
                <div>
                    <div class="project-counts">
                        <h4 class="fontsize-m semi-bold">File Counts</h4>
                        <div>
                            <p class="fontsize-xs semi-bold lhs">Fastq</p>
                            <p class="fontsize-xs rhs">{{state.project.project.rawCount | localeString}}</p>
                        </div>
                        <div>
                            <p class="fontsize-xs semi-bold lhs">Bam</p>
                            <p class="fontsize-xs rhs">{{state.project.project.bamCount | localeString}}</p>
                        </div>
                        <div>
                            <p class="fontsize-xs semi-bold lhs">Matrix</p>
                            <p class="fontsize-xs rhs">{{state.project.project.matrixCount | localeString}}</p>
                        </div>
                        <div>
                            <p class="fontsize-xs semi-bold lhs">Other</p>
                            <p class="fontsize-xs rhs">{{state.project.project.otherCount | localeString}}</p>
                        </div>
                        <div>
                            <p class="fontsize-xs semi-bold lhs">Total</p>
                            <p class="fontsize-xs rhs">{{state.project.project.totalCount | localeString}}</p>
                        </div>
                    </div>
                    <div class="project-accessions">
                        <h4 class="fontsize-m semi-bold">Accessions</h4>
                        <div>
                            <p class="fontsize-xs semi-bold lhs">Array Express Accessions</p>
                            <div class="rhs">
                                <p class="fontsize-xs">{{stringifyValues(state.project.project.arrayExpressAccessions,
                                    "Unspecified")}}</p>
                            </div>
                        </div>
                        <div>
                            <p class="fontsize-xs semi-bold lhs">GEO Series Accessions</p>
                            <div class="rhs">
                                <p class="fontsize-xs">{{stringifyValues(state.project.project.geoSeriesAccessions,
                                    "Unspecified")}}</p>
                            </div>
                        </div>
                        <div>
                            <p class="fontsize-xs semi-bold lhs">INSDC Project Accessions</p>
                            <div class="rhs">
                                <p class="fontsize-xs">{{stringifyValues(state.project.project.insdcProjectAccessions,
                                    "Unspecified")}}</p>
                            </div>
                        </div>
                        <div>
                            <p class="fontsize-xs semi-bold lhs">INSDC Study Accessions</p>
                            <div class="rhs">
                                <p class="fontsize-xs">{{stringifyValues(state.project.project.insdcStudyAccessions,
                                    "Unspecified")}}</p>
                            </div>
                        </div>
                    </div>
                    <div class="data-release-policy">
                        <h4 class="fontsize-m semi-bold">Data Release Policy</h4>
                        <div class="stretch">
                            <p class="fontsize-xs">For information regarding data sharing and data use, please see our
                                <a href="https://www.humancellatlas.org/data-release-policy/"
                                   target="_blank"
                                   rel="noopener noreferrer">Data Release Policy</a></p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</pop-layout>
