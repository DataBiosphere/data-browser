<div class="wrapper">
    <div id="filter" class="filter">
        <input class="hca-input" type="text" placeholder="Search" aria-label="Number" matInput
               [formControl]="filterControl" #filterInput [matAutocomplete]="auto">
        <mat-autocomplete #auto="matAutocomplete" (optionSelected)="onTermSelected($event)"
                          [displayWith]="displayFn">
            <mat-optgroup class="hca-optgroup" *ngFor="let facet of filteredFacets$ | async" [label]="facet.facetName | camelToSpace"
                          [disabled]="facet.disabled">
                <mat-option class="hca-option" *ngFor="let term of facet.terms" [value]="{facet:facet, term:term}">
                    <span>{{term.termName}}</span>
                    <span>{{term.count}}</span>
                </mat-option>
            </mat-optgroup>
        </mat-autocomplete>
        <ng-container *ngFor="let facetGroup of facetGroups; let i = index">
            <div [ngClass]="getSelectClass(i)" (click)="onHCASelect(i)">
                <span>{{facetGroup.facetGroupName}}</span>
                <mat-icon>keyboard_arrow_down</mat-icon>
                <ng-container *ngIf="fileFacets.length">
                    <div [ngClass]="getOptionsClass(i)" [ngStyle]="setStyles(i, facetGroup.facetNames.length)" (mouseleave)="onHCASelectClose()">
                        <hca-file-facet [fileFacet]="getFacet(facetName)"
                                        *ngFor="let facetName of facetGroup.facetNames"></hca-file-facet>
                    </div>
                </ng-container>
            </div>
        </ng-container>
    </div>
</div>
<div *ngIf="selectIndex != null" class="hca-select-overlay" (click)="onHCASelectClose()"></div>
