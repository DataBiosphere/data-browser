<div *ngIf="state$ | async as state">
    <ng-container *ngIf="isDownloadNotStarted(state.manifestResponse)">
        <hca-get-data-panel [loading]="isFileTypeSummariesEmpty(state.fileManifestFileSummary)">
            <h4 class="fontsize-m semi-bold">Select Manifest File Types</h4>
            <p class="fontsize-m">A file manifest contains a list of data files matching your search criteria along with
                a subset of the metadata.</p>
            <p class="fontsize-m">Please select the file types for inclusion in the manifest.</p>
        </hca-get-data-panel>
        <ng-container *ngIf="!isFileTypeSummariesEmpty(state.fileManifestFileSummary)">
            <file-type-summary-list [selectedSearchTermNames]="state.selectedSearchTermNames"
                                    [fileTypeSummaries]="getFileTypeSummaries(state.fileManifestFileSummary)"></file-type-summary-list>
            <button class="button primary" type="button" (click)="onRequestManifest()" [disabled]="!isAnyFileFormatSelected(state.selectedSearchTerms)">Prepare Manifest</button>
        </ng-container>
    </ng-container>
    <ng-container *ngIf="isDownloadInProgress(state.manifestResponse)">
        <hca-get-data-panel [loading]="isDownloadInProgress(state.manifestResponse)">
            <h4 class="fontsize-m semi-bold">Your File Manifest is Being Prepared</h4>
            <p class="fontsize-m">Your manifest will be ready shortly.</p>
        </hca-get-data-panel>
    </ng-container>
    <ng-container *ngIf="isDownloadComplete(state.manifestResponse)">
        <hca-get-data-panel>
            <h4 class="fontsize-m semi-bold">Your File Manifest is Ready</h4>
        </hca-get-data-panel>
        <p class="fontsize-m">Select the link below to download your manifest.</p>
        <p class="fontsize-m">This link expires in 24 hours.</p>
        <copy-to-clipboard [copyToClipboardLink]="state.manifestResponse.fileUrl"></copy-to-clipboard>
        <p class="fontsize-m">Once you have downloaded your manifest, use the HCA Command Line Interface (HCA CLI) to download the files listed in your
            manifest along with their associated metadata.</p>
        <p class="fontsize-m"><a target="_blank"
                                 href="{{portalURL}}/guides#downloading-a-data-manifest">View HCA CLI
            Instructions</a></p>
    </ng-container>
</div>
